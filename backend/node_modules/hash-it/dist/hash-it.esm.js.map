{"version":3,"file":"hash-it.esm.js","sources":["../src/hash.ts","../src/constants.ts","../src/arrayBuffer.ts","../src/stringify.ts","../src/index.ts"],"sourcesContent":["/**\n * based on string passed, get the integer hash value\n * through bitwise operation (based on spinoff of dbj2\n * with enhancements for reduced collisions)\n *\n * @param string the string to get the hash value for\n * @returns the hash value\n */\nfunction getUniqueIntegerFromString(string: string) {\n  let index = string.length;\n  let hashA = 5381;\n  let hashB = 52711;\n  let charCode;\n\n  while (index--) {\n    charCode = string.charCodeAt(index);\n\n    hashA = (hashA * 33) ^ charCode;\n    hashB = (hashB * 33) ^ charCode;\n  }\n\n  return (hashA >>> 0) * 4096 + (hashB >>> 0);\n}\n\nexport default getUniqueIntegerFromString;\n","type ElementOf<T> = T extends (infer E)[]\n  ? E\n  : T extends readonly (infer E)[]\n  ? E\n  : never;\n\ntype MappedFlag<Type extends readonly any[]> = {\n  [Key in ElementOf<Type>]: true;\n};\n\ntype MappedClass<Type extends readonly any[]> = {\n  [Key in ElementOf<Type>]: `[object ${Key}]`;\n};\n\ntype MappedReverseClass<Type extends readonly any[]> = {\n  [Key in ElementOf<Type> as `[object ${Key}]`]: Key;\n};\n\nconst getClassTypes = <\n  Classes extends readonly any[],\n  Reversed extends boolean,\n>(\n  classes: Classes,\n  reversed: Reversed,\n): Reversed extends true ? MappedReverseClass<Classes> : MappedClass<Classes> =>\n  classes.reduce((map, className: Classes[number]) => {\n    const toStringClassName = `[object ${className}]`;\n\n    if (reversed) {\n      map[toStringClassName] = className;\n    } else {\n      map[className] = toStringClassName;\n    }\n\n    return map;\n  }, {});\n\nconst getFlags = <Flags extends readonly any[]>(\n  flags: Flags,\n): MappedFlag<Flags> =>\n  flags.reduce((flag, item: Flags[number]) => {\n    flag[item] = true;\n\n    return flag;\n  }, {});\n\nconst OBJECT_CLASSES = [\n  // self tags\n  'Array',\n  'Arguments',\n\n  'Object',\n\n  // toString tags\n  'RegExp',\n  'Symbol',\n\n  // iterable tags\n  'Map',\n  'Set',\n\n  'Date',\n\n  'Error',\n\n  'Event',\n\n  // bailout tags\n  'Generator',\n  'Promise',\n  'WeakMap',\n  'WeakSet',\n\n  'DocumentFragment',\n\n  // typed array tags\n  'Float32Array',\n  'Float64Array',\n  'Int8Array',\n  'Int16Array',\n  'Int32Array',\n  'Uint8Array',\n  'Uint8ClampedArray',\n  'Uint16Array',\n  'Uint32Array',\n\n  'ArrayBuffer',\n\n  'DataView',\n\n  'DocumentFragment',\n\n  'Window',\n\n  // primitive classes, e.g. new String()\n  'String',\n  'Number',\n  'Boolean',\n  'Function',\n  'Undefined',\n  'GeneratorFunction',\n  'BigInt',\n  'Null',\n] as const;\n\nexport const OBJECT_CLASS_TYPE = getClassTypes(OBJECT_CLASSES, false);\nexport const OBJECT_CLASS = getClassTypes(OBJECT_CLASSES, true);\n\nexport const BAILOUT_TAGS = getFlags([\n  OBJECT_CLASS_TYPE.Generator,\n  OBJECT_CLASS_TYPE.Promise,\n  OBJECT_CLASS_TYPE.WeakMap,\n  OBJECT_CLASS_TYPE.WeakSet,\n]);\n\nexport const ITERABLE_TAGS = getFlags([\n  OBJECT_CLASS_TYPE.Map,\n  OBJECT_CLASS_TYPE.Set,\n]);\n\nexport const NORMALIZED_TAGS = getFlags([\n  OBJECT_CLASS_TYPE.Date,\n  OBJECT_CLASS_TYPE.RegExp,\n]);\n\nexport const PRIMITIVE_TAGS = getFlags([\n  'bigint',\n  'boolean',\n  'function',\n  'number',\n  'string',\n  'undefined',\n]);\n\nexport const SELF_TAGS = getFlags([\n  OBJECT_CLASS_TYPE.Arguments,\n  OBJECT_CLASS_TYPE.Array,\n]);\n\nexport const TO_STRING_TAGS = getFlags([\n  OBJECT_CLASS_TYPE.RegExp,\n  OBJECT_CLASS_TYPE.Symbol,\n]);\n\nexport const TYPED_ARRAY_TAGS = getFlags([\n  OBJECT_CLASS_TYPE.Float32Array,\n  OBJECT_CLASS_TYPE.Float64Array,\n  OBJECT_CLASS_TYPE.Int8Array,\n  OBJECT_CLASS_TYPE.Int16Array,\n  OBJECT_CLASS_TYPE.Int32Array,\n  OBJECT_CLASS_TYPE.Uint8Array,\n  OBJECT_CLASS_TYPE.Uint8ClampedArray,\n  OBJECT_CLASS_TYPE.Uint16Array,\n  OBJECT_CLASS_TYPE.Uint32Array,\n]);\n","const HAS_BUFFER_FROM_SUPPORT =\n  typeof Buffer !== 'undefined' && typeof Buffer.from === 'function';\nconst HAS_UINT16ARRAY_SUPPORT = typeof Uint16Array === 'function';\n\n/**\n * get the string value of the buffer passed based on a Buffer\n *\n * @param buffer the array buffer to convert\n * @returns the stringified buffer\n */\nexport function getStringifiedArrayBufferFallback(\n  buffer: ArrayBufferLike,\n): string {\n  return String.fromCharCode.apply(\n    null,\n    new Uint16Array(buffer) as unknown as number[],\n  );\n}\n\n/**\n * get the string value of the buffer passed based on a Uint16Array\n *\n * @param buffer the array buffer to convert\n * @returns the stringified buffer\n */\nexport function getStringifiedArrayBufferModern(\n  buffer: ArrayBufferLike,\n): string {\n  return Buffer.from(buffer).toString('utf8');\n}\n\n/**\n * return a placeholder when no arraybuffer support exists\n *\n * @returns the placeholder\n */\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nexport function getStringifiedArrayBufferNoSupport(buffer: ArrayBufferLike) {\n  return '';\n}\n\n/**\n * @function getStringifiedArrayBuffer\n *\n * @description\n * get the string value of the buffer passed\n *\n * @param {ArrayBuffer} buffer the array buffer to convert\n * @returns {string} the stringified buffer\n */\nexport const getStringifiedArrayBuffer = (() => {\n  if (HAS_BUFFER_FROM_SUPPORT) {\n    return getStringifiedArrayBufferModern;\n  }\n\n  if (HAS_UINT16ARRAY_SUPPORT) {\n    return getStringifiedArrayBufferFallback;\n  }\n\n  return getStringifiedArrayBufferNoSupport;\n})();\n","import {\n  BAILOUT_TAGS,\n  ITERABLE_TAGS,\n  NORMALIZED_TAGS,\n  OBJECT_CLASS,\n  OBJECT_CLASS_TYPE,\n  PRIMITIVE_TAGS,\n  SELF_TAGS,\n  TO_STRING_TAGS,\n  TYPED_ARRAY_TAGS,\n} from './constants';\nimport { getStringifiedArrayBuffer } from './arrayBuffer';\n\ntype ObjectClass = keyof typeof OBJECT_CLASS;\n\nconst XML_ELEMENT_REGEXP = /\\[object ([HTML|SVG](.*)Element)\\]/;\n\nconst toString = Object.prototype.toString;\nconst keys = Object.keys;\n\n/**\n * get the event object sorted by its properties\n *\n * @param event the event to sort\n * @returns the event object with all properties sorted\n */\nfunction getSortedEvent(event: Event) {\n  return {\n    bubbles: event.bubbles,\n    cancelBubble: event.cancelBubble,\n    cancelable: event.cancelable,\n    composed: event.composed,\n    currentTarget: event.currentTarget,\n    defaultPrevented: event.defaultPrevented,\n    eventPhase: event.eventPhase,\n    isTrusted: event.isTrusted,\n    returnValue: event.returnValue,\n    target: event.target,\n    type: event.type,\n  };\n}\n\n/**\n * get the sort result based on the two values to compare\n *\n * @param first the first value to compare\n * @param second the second value to compare\n * @returns should the value be sorted\n */\nfunction shouldSort(first: string, second: string) {\n  return first > second;\n}\n\n/**\n * get the sort result based on the two pairs to compare\n *\n * @param firstPair the first pair to compare\n * @param secondPair the second pair to compare\n * @returns should the value be sorted\n */\nfunction shouldSortPair(\n  firstPair: [string, string],\n  secondPair: [string, string],\n) {\n  return firstPair[0] > secondPair[0];\n}\n\n/**\n * sort the array based on the fn passed\n *\n * @param array the array to sort\n * @param fn the sorting function\n * @returns the sorted array\n */\nfunction sort(array: any[], fn: (item: any, comparisonItem: any) => boolean) {\n  let subIndex;\n  let value;\n\n  for (let index = 0; index < array.length; ++index) {\n    value = array[index];\n\n    for (\n      subIndex = index - 1;\n      ~subIndex && fn(array[subIndex], value);\n      --subIndex\n    ) {\n      array[subIndex + 1] = array[subIndex];\n    }\n\n    array[subIndex + 1] = value;\n  }\n\n  return array;\n}\n\n/**\n * get the pairs in the map for stringification\n *\n * @param map the map to get the pairs for\n * @returns the sorted, stringified map\n */\nfunction getSortedMap(map: Map<any, any>, cache: any[], keys: string[]) {\n  const entries: string[] = [];\n\n  map.forEach((value: any, key: any) => {\n    entries.push([\n      stringify(key, cache, keys),\n      stringify(value, cache, keys),\n    ] as unknown as string);\n  });\n\n  sort(entries, shouldSortPair);\n\n  for (let index = 0, entry; index < entries.length; ++index) {\n    entry = entries[index];\n    entries[index] = `[${entry[0]},${entry[1]}]`;\n  }\n\n  return `Map|[${entries.join(',')}]`;\n}\n\n/**\n * get the values in the set for stringification\n *\n * @param set the set to get the values for\n * @returns the sorted, stringified set\n */\nfunction getSortedSet(set: Set<any>, cache: any[], keys: string[]) {\n  const entries: string[] = [];\n\n  set.forEach((value: any) => {\n    entries.push(stringify(value, cache, keys));\n  });\n\n  sort(entries, shouldSort);\n\n  return `Set|[${entries.join(',')}]`;\n}\n\n/**\n * get the object with the keys sorted\n *\n * @param object the object to sort\n * @returns the sorted object\n */\nfunction getSortedObject<UnsortedObject>(object: UnsortedObject) {\n  const objectKeys = sort(keys(object), shouldSort);\n  const newObject = {} as UnsortedObject;\n\n  let key: keyof UnsortedObject;\n\n  for (let index = 0; index < objectKeys.length; ++index) {\n    key = objectKeys[index];\n\n    newObject[key] = object[key];\n  }\n\n  return newObject;\n}\n\n/**\n * build a string based on all the fragment's children\n *\n * @param fragment the fragment to stringify\n * @returns the stringified fragment\n */\nfunction getStringifiedDocumentFragment(fragment: DocumentFragment) {\n  const children = fragment.children;\n  const innerHTML: string[] = [];\n\n  for (let index = 0; index < children.length; ++index) {\n    innerHTML.push(children[index].outerHTML);\n  }\n\n  return innerHTML.join(',');\n}\n\n/**\n * get the index after that of the value match in the array (faster than\n * native indexOf) to determine the cutoff index for the `splice()` call.\n *\n * @param array the array to get the index of the value at\n * @param value the value to match\n * @returns the index after the value match in the array\n */\nfunction getCutoffIndex(array: any[], value: any) {\n  for (let index = 0; index < array.length; ++index) {\n    if (array[index] === value) {\n      return index + 1;\n    }\n  }\n\n  return 0;\n}\n\n/**\n * get the value normalized for stringification\n *\n * @param value the value to normalize\n * @param sortedCache the cache of sorted objects\n * @param passedTag the previously-calculated tag\n * @returns the normalized value\n */\nfunction getNormalizedValue(\n  value: any,\n  cache?: any[],\n  keys?: string[],\n  passedTag?: ObjectClass,\n) {\n  if (!passedTag) {\n    const type = typeof value;\n\n    if (PRIMITIVE_TAGS[type as keyof typeof PRIMITIVE_TAGS]) {\n      return `${type}|${value}`;\n    }\n\n    if (value === null) {\n      return `${value}|${value}`;\n    }\n  }\n\n  const tag = passedTag || (toString.call(value) as ObjectClass);\n\n  if (SELF_TAGS[tag as keyof typeof SELF_TAGS]) {\n    return value;\n  }\n\n  if (tag === OBJECT_CLASS_TYPE.Object) {\n    return getSortedObject(value);\n  }\n\n  if (TO_STRING_TAGS[tag as keyof typeof TO_STRING_TAGS]) {\n    return `${OBJECT_CLASS[tag]}|${value.toString()}`;\n  }\n\n  if (ITERABLE_TAGS[tag as keyof typeof ITERABLE_TAGS]) {\n    return value instanceof Map\n      ? getSortedMap(value, cache as any[], keys as string[])\n      : getSortedSet(value, cache as any, keys as string[]);\n  }\n\n  if (tag === OBJECT_CLASS_TYPE.Date) {\n    return `${OBJECT_CLASS[tag]}|${value.getTime()}`;\n  }\n\n  if (tag === OBJECT_CLASS_TYPE.Error) {\n    return `${OBJECT_CLASS[tag]}|${value.stack}`;\n  }\n\n  if (tag === OBJECT_CLASS_TYPE.Event) {\n    return getSortedEvent(value);\n  }\n\n  if (BAILOUT_TAGS[tag as keyof typeof BAILOUT_TAGS]) {\n    return `${OBJECT_CLASS[tag]}|NOT_ENUMERABLE`;\n  }\n\n  if (XML_ELEMENT_REGEXP.test(tag)) {\n    return `${tag.slice(8, -1)}|${value.outerHTML}`;\n  }\n\n  if (tag === OBJECT_CLASS_TYPE.DocumentFragment) {\n    return `${OBJECT_CLASS[tag]}|${getStringifiedDocumentFragment(value)}`;\n  }\n\n  if (TYPED_ARRAY_TAGS[tag as keyof typeof TYPED_ARRAY_TAGS]) {\n    return `${OBJECT_CLASS[tag]}|${value.join(',')}`;\n  }\n\n  if (tag === OBJECT_CLASS_TYPE.ArrayBuffer) {\n    return `${OBJECT_CLASS[tag]}|${getStringifiedArrayBuffer(value)}`;\n  }\n\n  if (tag === OBJECT_CLASS_TYPE.DataView) {\n    return `${OBJECT_CLASS[tag]}|${getStringifiedArrayBuffer(value.buffer)}`;\n  }\n\n  return value;\n}\n\n/**\n * create the replacer function used for stringification\n *\n * @param sortedCache the cache to use for sorting objects\n * @returns function getting the normalized value\n */\nfunction createReplacer(cache: any[] = [], keys: string[] = []) {\n  return function (this: any, key: string, value: any) {\n    if (typeof value === 'object') {\n      if (cache.length) {\n        const thisCutoff = getCutoffIndex(cache, this);\n\n        if (thisCutoff === 0) {\n          cache.push(this);\n        } else {\n          cache.splice(thisCutoff);\n          keys.splice(thisCutoff);\n        }\n\n        keys.push(key);\n\n        const valueCutoff = getCutoffIndex(cache, value);\n\n        if (valueCutoff !== 0) {\n          return `[~${keys.slice(0, valueCutoff).join('.') || '.'}]`;\n        }\n\n        cache.push(value);\n      } else {\n        cache[0] = value;\n        keys[0] = key;\n      }\n    }\n\n    if (key && this[key] instanceof Date) {\n      return getNormalizedValue(this[key], cache, keys, OBJECT_CLASS_TYPE.Date);\n    }\n\n    return getNormalizedValue(value, cache, keys);\n  };\n}\n\n/**\n * stringify the value based on the options passed\n *\n * @param value the value to stringify\n * @returns the stringified value\n */\nfunction stringify(value: any, cache?: any[], keys?: string[]): string {\n  if (!value || typeof value !== 'object') {\n    return getNormalizedValue(value, cache, keys);\n  }\n\n  const tag = toString.call(value) as ObjectClass;\n\n  if (NORMALIZED_TAGS[tag as keyof typeof NORMALIZED_TAGS]) {\n    return getNormalizedValue(value, cache, keys, tag);\n  }\n\n  return JSON.stringify(value, createReplacer(cache, keys));\n}\n\nexport default stringify;\n","import getUniqueIntegerFromString from './hash';\nimport stringify from './stringify';\n\n/**\n * hash the value passed to a unique, consistent hash value\n *\n * @param value the value to hash\n * @returns the object hash\n */\nfunction hash(value: any) {\n  return getUniqueIntegerFromString(stringify(value));\n}\n\nfunction is(value: any, otherValue: any) {\n  return hash(value) === hash(otherValue);\n}\n\nfunction isAll(value: any, ...otherValues: any[]) {\n  for (let index = 0; index < otherValues.length; ++index) {\n    if (!is(value, otherValues[index])) {\n      return false;\n    }\n  }\n\n  return true;\n}\n\nfunction isAny(value: any, ...otherValues: any[]) {\n  for (let index = 0; index < otherValues.length; ++index) {\n    if (is(value, otherValues[index])) {\n      return true;\n    }\n  }\n\n  return false;\n}\n\nfunction isNot(value: any, otherValue: any) {\n  return hash(value) !== hash(otherValue);\n}\n\nis.all = isAll;\nis.any = isAny;\nis.not = isNot;\n\nhash.is = is;\n\nexport default hash;\n"],"names":["getUniqueIntegerFromString","string","index","length","hashA","hashB","charCode","charCodeAt","getClassTypes","classes","reversed","reduce","map","className","toStringClassName","getFlags","flags","flag","item","OBJECT_CLASSES","OBJECT_CLASS_TYPE","OBJECT_CLASS","BAILOUT_TAGS","Generator","Promise","WeakMap","WeakSet","ITERABLE_TAGS","Map","Set","NORMALIZED_TAGS","Date","RegExp","PRIMITIVE_TAGS","SELF_TAGS","Arguments","Array","TO_STRING_TAGS","Symbol","TYPED_ARRAY_TAGS","Float32Array","Float64Array","Int8Array","Int16Array","Int32Array","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","HAS_BUFFER_FROM_SUPPORT","Buffer","from","HAS_UINT16ARRAY_SUPPORT","getStringifiedArrayBufferFallback","buffer","String","fromCharCode","apply","getStringifiedArrayBufferModern","toString","getStringifiedArrayBufferNoSupport","getStringifiedArrayBuffer","XML_ELEMENT_REGEXP","Object","prototype","keys","getSortedEvent","event","bubbles","cancelBubble","cancelable","composed","currentTarget","defaultPrevented","eventPhase","isTrusted","returnValue","target","type","shouldSort","first","second","shouldSortPair","firstPair","secondPair","sort","array","fn","subIndex","value","getSortedMap","cache","entries","forEach","key","push","stringify","entry","join","getSortedSet","set","getSortedObject","object","objectKeys","newObject","getStringifiedDocumentFragment","fragment","children","innerHTML","outerHTML","getCutoffIndex","getNormalizedValue","passedTag","tag","call","getTime","Error","stack","Event","test","slice","DocumentFragment","ArrayBuffer","DataView","createReplacer","thisCutoff","splice","valueCutoff","JSON","hash","is","otherValue","isAll","isAny","isNot","all","any","not"],"mappings":"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"}